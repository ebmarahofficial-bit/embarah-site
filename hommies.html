<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Choose Your Hommie</title>
<style>
  :root{
    --row-top-desktop: 53%;
    --row-height-desktop: 12%;
    --row-top-mobile: 66%;
    --row-height-mobile: 12%;
  }

  html, body { margin:0; height:100%; background:#000; overflow:hidden; }

  /* Fallback background (poster image). Put a JPG/PNG here that matches your video. */
  body {
    background: #000 center / cover no-repeat fixed;
    /* fallback will be set by JS to assets/hommiesbg_poster.jpg */
  }

  /* Fullscreen video */
  #bgVideo{
    position:fixed; inset:0;
    width:100vw; height:100vh;
    object-fit:cover; object-position:center;
    z-index:-1;
    background:transparent;
    display:block;
  }

  /* Clickable hotspots */
  .hotspots{ position:fixed; inset:0; pointer-events:none; }
  .spot{ position:absolute; display:block; pointer-events:auto; text-decoration:none; }

  /* Desktop layout */
  @media (min-width:769px){
    .spot{ top:var(--row-top-desktop); height:var(--row-height-desktop); }
    .spot.d00d     { left:13%; width:17%; }
    .spot.hvted    { left:33%; width:17%; }
    .spot.metallik { left:53%; width:17%; }
    .spot.fermilat { left:73%; width:17%; }
  }
  /* Mobile layout */
  @media (max-width:768px){
    .spot{ top:var(--row-top-mobile); height:var(--row-height-mobile); }
    .spot.d00d     { left:8%;  width:22%; }
    .spot.hvted    { left:30%; width:22%; }
    .spot.metallik { left:52%; width:22%; }
    .spot.fermilat { left:74%; width:22%; }
  }

  /* Debug outlines: open with ?debug=1 */
  body.debug .spot{ outline:2px dashed rgba(255,255,255,.6); background:rgba(255,255,255,.06); }
  body.debug #bgVideo{ outline:2px solid rgba(0,255,255,.4); }

  /* Error banner */
  #err{
    position:fixed; left:50%; top:12px; transform:translateX(-50%);
    background:#111; color:#fff; font:14px/1.3 system-ui, sans-serif;
    padding:10px 12px; border:1px solid #f33; border-radius:8px; display:none; z-index:10;
  }
</style>
</head>
<body>
<div id="err"></div>

<!-- Single video element; we swap .src in JS -->
<video id="bgVideo"
       autoplay muted loop playsinline webkit-playsinline
       preload="auto"></video>

<div class="hotspots" aria-label="Choose your character">
  <a class="spot d00d"     href="d00d.html"     aria-label="D00D"></a>
  <a class="spot hvted"    href="hvted.html"    aria-label="HVTED"></a>
  <a class="spot metallik" href="metallik.html" aria-label="MetalliK"></a>
  <a class="spot fermilat" href="fermilat.html" aria-label="Fermilat"></a>
</div>

<noscript>
  <!-- If JS is disabled, at least show a poster -->
  <style> #bgVideo{display:none} </style>
  <img src="assets/hommiesbg_poster.jpg" alt="Choose your character" style="position:fixed;inset:0;width:100vw;height:100vh;object-fit:cover;">
</noscript>

<script>
  const qs = new URLSearchParams(location.search);
  if (qs.get('debug') === '1') document.body.classList.add('debug');

  const v = document.getElementById('bgVideo');
  const err = document.getElementById('err');

  // Poster/fallback image (add this file to assets/)
  const poster = 'assets/hommiesbg_poster.jpg';
  document.body.style.backgroundImage = `url("${poster}")`;

  // Pick video source
  const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  const src = isMobile ? 'assets/hommiesbgmobile.mp4' : 'assets/hommiesbg.mp4';

  // Important: set muted & inline BEFORE setting src (iOS)
  v.muted = true;
  v.setAttribute('playsinline','');
  v.setAttribute('webkit-playsinline','');

  // Use direct src on the <video> for reliable swapping
  v.src = src;

  // Try to play; if browser blocks, the poster remains visible
  const start = () => v.play().catch(() => {});
  v.addEventListener('loadeddata', start, { once:true });
  v.addEventListener('canplay', start, { once:true });

  // If it completely fails, show an error (and we still have the poster)
  let failTimer = setTimeout(() => {
    if (v.readyState < 2) showErr('Timed out loading background video.');
  }, 7000);

  v.addEventListener('error', () => {
    showErr(`Failed to load: ${src} (code ${v.error && v.error.code || 'unknown'})`);
  });

  v.addEventListener('loadeddata', () => clearTimeout(failTimer));

  function showErr(message){
    err.style.display = 'block';
    err.textContent = `${message} Check path/case, that files exist in /assets/, and that the MP4 is H.264 video + AAC audio with Content-Type: video/mp4.`;
  }

  // Debug: show controls
  if (document.body.classList.contains('debug')) v.setAttribute('controls','controls');
</script>
</body>
</html>
