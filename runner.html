<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Ebmarah Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<style>
  :root{
    --neon:#00ff99; --ink:#eaffef; --panel:#0a1d15; --line:#0b3;
    --shadow:0 0 18px rgba(0,255,153,.35);
  }
  *{ box-sizing:border-box }
  html,body{ margin:0; height:100%; background:#000; color:var(--ink); font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; overflow:hidden; }

  /* --- Video background layer (behind everything) --- */
  #bg-video{
    position:fixed; inset:0;
    width:100%; height:100%;
    object-fit:cover;
    z-index:-2;
    background:#000;
    pointer-events:none;
  }

  /* Lightweight gradient fallback under video */
  body::before{
    content:""; position:fixed; inset:0; z-index:-3;
    background:
      radial-gradient(60% 80% at 30% 20%, rgba(0,255,153,.10), transparent 60%),
      radial-gradient(70% 70% at 80% 70%, rgba(0,180,120,.08), transparent 60%),
      linear-gradient(180deg, #030a07 0%, #061f16 100%);
    animation: glow 10s linear infinite alternate;
  }
  @keyframes glow{
    0%{ filter:hue-rotate(0deg) brightness(1); }
    100%{ filter:hue-rotate(10deg) brightness(1.05); }
  }

  .wrap{ min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:16px }

  /* Desktop/tablet stage: classic 16:9 with max 960px */
  .stage{
    position:relative;
    width:100%;
    max-width:960px;
    aspect-ratio:16/9;
    border:1px solid var(--line);
    border-radius:16px;
    box-shadow:var(--shadow);
    overflow:hidden;
    background:#04120d;
  }

  /* Phone: true fullscreen (only on touch devices) */
  @media (pointer:coarse) {
    .wrap{ padding:0; }
    .stage{
      max-width:none;
      width:100vw;
      height:100svh;      /* real visual height on modern mobile */
      aspect-ratio:auto;
      border-radius:0;
      border-width:0;
    }
    @supports not (height: 100svh) {
      .stage{ height:100vh; }
    }
  }

  canvas{
    position:absolute; inset:0;
    width:100%; height:100%;
    image-rendering:crisp-edges;
    image-rendering:pixelated;
    touch-action:none;
  }

  /* Optional start cover image (shows on menu) */
  .cover{
    position:absolute; inset:0; width:100%; height:100%; object-fit:cover;
    opacity:.25; filter:saturate(1.1); z-index:0;
  }

  /* ---------- HUD ---------- */
  .hud{
    position:absolute; top:10px; left:50%; transform:translateX(-50%);
    display:flex; gap:10px; align-items:center; font-weight:700; font-size:14px;
    background:rgba(0,0,0,.30); padding:6px 10px; border-radius:999px; border:1px solid rgba(0,255,153,.45);
    backdrop-filter: blur(4px);
    z-index:5;
  }
  .pill{ padding:2px 10px; border-radius:999px; background:rgba(0,255,153,.12); border:1px solid rgba(0,255,153,.35) }
  .hud button{ padding:4px 10px; border-radius:10px; border:1px solid var(--line); background:#062417; color:#eaffef; cursor:pointer }

  /* Exit button (shows during gameplay) */
  #exitBtn{
    position:absolute; top:10px; right:10px;
    padding:8px 12px; border-radius:8px;
    border:1px solid var(--line); background:#062417; color:#eaffef;
    font-weight:700; cursor:pointer; z-index:10;
  }

  /* ---------- Overlay (menu) ---------- */
  .overlay{
    position:absolute; inset:0; display:grid; place-items:center; background:rgba(0,0,0,0.6); z-index:20;
  }
  .panel{
    position:relative; z-index:2; width:min(92%, 780px);
    padding:20px; border:1px solid var(--line); background:rgba(10,29,21,.85);
    border-radius:16px; box-shadow:var(--shadow); text-align:center; backdrop-filter: blur(6px);
  }
  .title{ margin:0 0 6px; font-weight:900; letter-spacing:.06em; font-size: clamp(28px, 5.5vw, 56px); color:var(--neon); text-shadow: 0 0 24px rgba(0,255,153,.45); }
  .tagline{ margin:0 0 14px; font-weight:800; letter-spacing:.04em; opacity:.95; }
  .btnrow{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap }
  .btn{ padding:12px 16px; border:1px solid var(--line); background:#062417; color:#eaffef;
    border-radius:12px; cursor:pointer; font-weight:800; letter-spacing:.03em; box-shadow:var(--shadow) }

  /* ---------- Mobile controls ---------- */
  .controls{
    position:absolute; left:0; right:0; bottom:10px;
    display:flex; justify-content:space-between; gap:10px; padding:0 8px; pointer-events:none;
    z-index:5;
  }
  .controls button{
    pointer-events:auto; min-width:96px; min-height:56px; border-radius:14px;
    background:rgba(0,0,0,.35); border:1px solid rgba(0,255,153,.5); color:#eaffef; font-weight:800;
  }
  .controls .jump{ flex:1; min-width:120px }
  @media (max-width:520px){ .controls button{ min-width:78px; min-height:52px } }

  /* Hidden SoundCloud iframe */
  #sc-holder{ position:absolute; width:0; height:0; overflow:hidden }
</style>
</head>
<body>

  <!-- Video background (HTML is in root; video is in ./assets) -->
  <video id="bg-video" autoplay muted loop playsinline preload="auto">
    <source src="./assets/runnerbg.mp4" type="video/mp4">
  </video>

  <div class="wrap">
    <div class="stage" id="stage">
      <!-- Optional menu cover (from ./assets) -->
      <img class="cover" id="startCover" src="./assets/start_cover.png" alt="" />

      <button id="exitBtn" hidden>Exit</button>
      <canvas id="game" width="960" height="540" aria-label="Ebmarah Runner"></canvas>

      <!-- HUD -->
      <div class="hud" id="hud" hidden>
        <span class="pill">Lv <strong id="level">1</strong>/10</span>
        <span class="pill">üçå <strong id="bananas">0</strong>/<span id="nextReq">20</span></span>
        <span class="pill">Score <strong id="score">0</strong></span>
        <span class="pill">Best <strong id="best">0</strong></span>
        <span class="pill"><button id="pauseBtn">‚è∏ Pause</button></span>
        <span class="pill"><button id="muteBtn">üîä</button></span>
      </div>

      <!-- Overlay (menu) -->
      <div class="overlay" id="overlay">
        <div class="panel" id="panel">
          <h1 class="title">EBMARAH RUNNER</h1>
          <p class="tagline">Running Bass</p>
          <p style="opacity:.9;margin:.35rem 0 1rem 0">
            Collect bananas to level up. Avoid hazards.<br>
            Mobile: on-screen controls. Desktop: Arrow keys + Space/‚Üë to jump.
          </p>
          <div class="btnrow">
            <button class="btn" id="startBtn">Start</button>
            <button class="btn" id="selectBtn">Level Select</button>
          </div>
          <div id="levelSelect" hidden style="margin-top:12px">
            <p style="opacity:.9;margin:.35rem 0 .5rem 0">Choose a level (unlocks as you progress):</p>
            <div id="grid" style="display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:10px"></div>
          </div>
        </div>
      </div>

      <!-- Mobile controls -->
      <div class="controls" id="controls" hidden>
        <button id="leftBtn">‚óÄ</button>
        <button id="jumpBtn" class="jump">JUMP</button>
        <button id="rightBtn">‚ñ∂</button>
      </div>

      <!-- SoundCloud (hidden) -->
      <div id="sc-holder" aria-hidden="true">
        <iframe id="sc-iframe" allow="autoplay"
          src="https://w.soundcloud.com/player/?url=https://soundcloud.com/ebmarah/tracks&auto_play=false&visual=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false"
          width="100%" height="120" frameborder="0"></iframe>
      </div>
    </div>
  </div>

  <!-- Game JS (root -> ./js/runner.js) -->
  <script src="./js/runner.js"></script>
</body>
</html>
