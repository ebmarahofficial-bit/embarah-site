<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ebmarah ‚Äì Virtual Rave Room</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="assets/favicon.png" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    :root { --neon:#00ff99; --bg:#020d07; --ink:#e0ffe8; --glass:rgba(2,13,7,.65); }

    *{box-sizing:border-box;}
    html,body{height:100%; margin:0;}
    body{font-family:'Orbitron',sans-serif; color:var(--ink); background:var(--bg); overflow-x:hidden;}

    /* Background video */
    .video-bg{position:fixed; inset:0; z-index:-3; overflow:hidden;}
    .video-bg video{width:100%; height:100%; object-fit:cover; object-position:center;}

    /* Header */
    header{
      position:fixed; inset:0 0 auto 0;
      display:flex; justify-content:space-between; align-items:center;
      padding:12px 18px;
      background:var(--glass);
      border-bottom:1px solid rgba(0,255,128,.2);
      box-shadow:0 6px 24px rgba(0,0,0,.35);
      z-index:1000;
      backdrop-filter: blur(10px);
    }
    .brand{display:flex; gap:10px; align-items:center; font-weight:800; letter-spacing:.02em;}
    .brand img{height:40px;}
    .brand span{font-size:clamp(16px,2.6vw,22px)}
    nav.site-nav{display:flex; align-items:center; gap:22px;}
    nav.site-nav a{color:#76ffb2; text-decoration:none; font-weight:700; font-size:clamp(13px,1.6vw,14px);}
    nav.site-nav a:hover{color:#00ffea;}
    .menu-btn{
      display:none; background:none; border:1px solid rgba(0,255,128,.35);
      color:#b9ffdf; font-size:16px; font-weight:700; padding:8px 12px; border-radius:10px
    }

    /* Drawer (mobile) */
    .drawer-overlay{position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:999; opacity:0; pointer-events:none; transition:.25s;}
    .drawer{
      position:fixed; top:0; right:-320px; width:min(80vw,320px); height:100%;
      background:#03140c; border-left:1px solid rgba(0,255,128,.25);
      box-shadow:-12px 0 40px rgba(0,0,0,.45); z-index:1000;
      transition:right .25s ease;
      display:flex; flex-direction:column; padding:18px;
    }
    .drawer header{all:unset; display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;}
    .drawer h2{margin:0; font-size:18px; color:#9dffd2;}
    .drawer .close{background:none; border:1px solid rgba(0,255,128,.35); color:#b9ffdf; padding:6px 10px; border-radius:10px}
    .drawer nav{display:flex; flex-direction:column; margin-top:12px}
    .drawer nav a{
      padding:14px 10px; border-bottom:1px solid rgba(0,255,128,.15);
      color:#b9ffdf; text-decoration:none; font-weight:800; letter-spacing:.02em; font-size:16px;
    }
    .drawer-open .drawer{right:0;}
    .drawer-open .drawer-overlay{opacity:1; pointer-events:auto;}

    /* Page spacing */
    .spacer{height:70px;}

    /* Centered chat-only layout */
    .wrap{max-width:1000px; margin:0 auto; padding:18px;}
    .chat-pane{
      margin: 0 auto 100px; /* leave space for bottom mini-player */
      background: rgba(0,0,0,.25); /* transparent glassy frame */
      border:1px solid rgba(0,255,128,.25);
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
      backdrop-filter:saturate(110%) blur(2px);
      overflow:hidden;
    }
    .chat-pane h2{
      margin:0; padding:12px 14px; font-size:16px; color:#9dffd2;
      border-bottom:1px solid rgba(0,255,128,.15);
      background:rgba(0,255,128,.06);
    }
    .chat-body{padding:0;}
    .chat-body iframe{
      display:block; width:100%; height:65vh; border:0; background:transparent;
    }

    /* Hidden SC driver iframe (no visual UI) */
    .sc-driver{
      position:absolute; width:1px; height:1px; opacity:0; pointer-events:none; left:-9999px; top:auto; border:0;
    }

    /* Mini player */
    .mini-player{
      position:fixed; left:50%; bottom:16px; transform:translateX(-50%);
      z-index:1100; display:flex; align-items:center; gap:10px;
      padding:8px 12px; border:1px solid rgba(0,255,128,.35); border-radius:12px;
      background:rgba(0,0,0,.30); box-shadow:0 8px 24px rgba(0,0,0,.35);
      backdrop-filter:saturate(110%) blur(2px);
    }
    .mini-player button{
      border:1px solid rgba(0,255,128,.45); background:transparent; color:#b9ffdf;
      font-weight:800; padding:6px 10px; border-radius:10px; cursor:pointer;
    }
    .mini-player button:hover{ color:#00ffea; border-color:#00ffea; }
    .mini-player .title{
      max-width:min(48vw,520px); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      font-size:12px; letter-spacing:.02em; color:#76ffb2;
    }
    .mini-player .dot{ width:6px; height:6px; border-radius:50%; margin-left:2px;
      background:#ff5c5c; box-shadow:0 0 8px #ff5c5c; display:inline-block; }
    .mini-player.playing .dot{ background:#00ffa0; box-shadow:0 0 8px #00ffa0; }
    .volume{ display:flex; align-items:center; gap:8px; margin-left:6px; }
    .volume input[type="range"]{
      -webkit-appearance:none; appearance:none; width:110px; height:8px;
      background:rgba(0,255,128,.18); border:1px solid rgba(0,255,128,.35); border-radius:999px; outline:none;
    }
    .volume input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; width:16px; height:16px; border-radius:50%;
      background:#00ff99; border:1px solid #0b3; cursor:pointer; box-shadow:0 0 12px rgba(0,255,153,.6);
    }
    .volume input[type="range"]::-moz-range-thumb{
      width:16px; height:16px; border-radius:50%;
      background:#00ff99; border:1px solid #0b3; cursor:pointer; box-shadow:0 0 12px rgba(0,255,153,.6);
    }
    .vol-label{font-size:11px; color:#9dffd2; opacity:.9}

    /* Responsive */
    @media (max-width: 960px){
      nav.site-nav{ display:none; }
      .menu-btn{ display:inline-flex; }
      .mini-player .title{ max-width:50vw; }
      .volume input[type="range"]{ width:90px; }
      .chat-body iframe{ height:60vh; }
    }
    @media (max-width: 520px){
      .mini-player{left:12px; right:12px; transform:none; justify-content:space-between; padding:10px 12px; gap:8px;}
      .mini-player .title{ max-width:44vw; }
      .volume input[type="range"]{ width:78px; }
      header{ padding:10px 12px; }
      .brand img{ height:34px; }
      .btn-text{ display:none; }
    }
    @supports (padding: max(0px)){
      .mini-player{ bottom: max(16px, env(safe-area-inset-bottom)); }
    }
  </style>
</head>
<body>
  <!-- Background -->
  <div class="video-bg" aria-hidden="true">
    <video autoplay loop muted playsinline preload="auto">
      <source src="video/visual.mp4" type="video/mp4" />
    </video>
  </div>

  <!-- Header -->
  <header>
    <div class="brand">
      <img src="assets/favicon.png" alt="Ebmarah"><span>Ebmarah</span>
    </div>
    <nav class="site-nav" aria-label="Primary">
      <a href="index.html">Home</a>
       <!-- <a href="music.html">Music</a> -->
      <a href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <a href="virtual-rave-room.html">Virtual Rave Room</a>
      <!-- <a href="game.html">Game</a> -->
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <a href="ebmarahgame.html">Game</a>
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
    <button class="menu-btn" id="menuBtn" aria-haspopup="true" aria-expanded="false" aria-controls="drawer">Menu</button>
  </header>

  <!-- Drawer -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
  <aside class="drawer" id="drawer" role="dialog" aria-modal="true" aria-label="Site menu">
    <header>
      <h2>Menu</h2>
      <button class="close" id="drawerClose" aria-label="Close menu">Close</button>
    </header>
    <nav aria-label="Mobile">
      <a href="index.html">Home</a>
      <!-- <a href="music.html">Music</a> -->
      <a href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <a href="virtual-rave-room.html">Virtual Rave Room</a>
      <!-- <a href="game.html">Game</a> -->
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <!-- <a href="ebmarahgame.html">Game</a> -->
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
  </aside>

  <div class="spacer"></div>

  <!-- Centered tlk.io chat -->
  <main class="wrap">
    <section class="chat-pane">
      <h2>üí¨ Live Chat</h2>
      <div class="chat-body">
        <!-- tlk.io room -->
        <iframe
          id="tlkFrame"
          title="Live chat"
          src="https://tlk.io/ebmarahs-virtual-rave-room">
        </iframe>
      </div>
    </section>
  </main>

  <!-- Hidden SoundCloud driver (no visible embed) -->
  <iframe
    class="sc-driver"
    allow="autoplay"
    src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/ebmarah&visual=false&show_artwork=false&show_user=false&show_comments=false&sharing=false&buying=false&download=false&liking=false&auto_play=false&hide_related=true&single_active=true&color=%2300ff99&theme_color=transparent"
    title="Ebmarah SoundCloud Driver">
  </iframe>

  <!-- Bottom mini-player -->
  <div class="mini-player" id="miniPlayer" aria-live="polite">
    <button id="scPrev" aria-label="Previous track">‚èÆ <span class="btn-text">Prev</span></button>
    <button id="scToggle" aria-label="Play/Pause">‚ñ∂ <span class="btn-text">Play</span></button>
    <button id="scNext" aria-label="Next track">‚è≠ <span class="btn-text">Next</span></button>
    <span class="title" id="scTitle">Loading‚Ä¶</span><span class="dot" aria-hidden="true"></span>
    <div class="volume" aria-label="Volume">
      <span class="vol-label">VOL</span>
      <input id="scVol" type="range" min="0" max="100" step="1" value="70"
             aria-valuemin="0" aria-valuemax="100" aria-valuenow="70" />
    </div>
  </div>

  <!-- OPTIONAL Mascot -->
  <script src="js/ebmarah-mascot.js"></script>
  <script>
    EbmarahMascot?.init?.({ mode:'passive', position:'bottom-right',
      funnyLines:['BASS INCOMING','sub-bass handshake!','gorilla certified üîä','who threw this banana?','i smell a DROP...'] });
  </script>

  <!-- SoundCloud API -->
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <!-- 
  eb-dropdown.js: Replaces your desktop navigation (nav.site-nav) with a compact 
  "MENU" dropdown on screens >=1024px. Keeps your mobile nav intact on smaller 
  screens. The MENU button is pinned top-right and automatically lists your nav links. 
   -->
   <script src="js/eb-dropdown.js" defer></script>

  <!-- 
  weekly-locker.js: Alternates locking between ebmarahgame.html and drum-pad.html 
  each week. One link is locked (unclickable, dimmed, üîí added) while the other is 
  available. The lock/unlock switches automatically every Sunday at midnight (local time). 
-->
<script src="js/weekly-locker.js" defer></script>

  
  <!-- easter egg -->

  <script src="js/shutupjustin.js"></script>

  <!-- Mini-player wiring -->
  <script>
    (function(){
      const frame = document.querySelector('.sc-driver');
      const widget = SC.Widget(frame);

      const btnPrev  = document.getElementById('scPrev');
      const btnPlay  = document.getElementById('scToggle');
      const btnNext  = document.getElementById('scNext');
      const titleEl  = document.getElementById('scTitle');
      const bar      = document.getElementById('miniPlayer');
      const volInput = document.getElementById('scVol');

      let ready = false, isPlaying = false, hasMultiple = true;

      function updateTitle(){
        widget.getCurrentSound(function(s){
          titleEl.textContent = (s && s.title) ? s.title : 'Ready';
        });
      }
      function updateState(playing){
        isPlaying = playing;
        btnPlay.innerHTML = playing ? '‚è∏ <span class="btn-text">Pause</span>' : '‚ñ∂ <span class="btn-text">Play</span>';
        bar.classList.toggle('playing', playing);
      }
      function setButtonsEnabled(enabled){
        [btnPrev, btnPlay, btnNext, volInput].forEach(el => el.disabled = !enabled);
      }
      function setSkipEnabled(enabled){
        btnPrev.disabled = !enabled; btnNext.disabled = !enabled;
      }

      widget.bind(SC.Widget.Events.READY, function(){
        ready = true;
        widget.setVolume(parseInt(volInput.value,10) || 70);
        widget.getSounds(function(list){
          hasMultiple = Array.isArray(list) && list.length > 1;
          setSkipEnabled(hasMultiple);
        });
        setButtonsEnabled(true);
        updateTitle();
      });

      widget.bind(SC.Widget.Events.PLAY,  function(){ updateState(true);  updateTitle(); });
      widget.bind(SC.Widget.Events.PAUSE, function(){ updateState(false); });
      widget.bind(SC.Widget.Events.FINISH,function(){ updateState(false); });
      widget.bind(SC.Widget.Events.PLAY_PROGRESS, function(e){ if(e.currentPosition < 1200){ updateTitle(); } });

      btnPlay.addEventListener('click', function(){ if(!ready) return; isPlaying ? widget.pause() : widget.play(); });
      btnPrev.addEventListener('click', function(){ if(!ready || !hasMultiple) return; widget.prev(); });
      btnNext.addEventListener('click', function(){ if(!ready || !hasMultiple) return; widget.next(); });
      volInput.addEventListener('input', function(){
        if(!ready) return;
        const v = parseInt(this.value,10);
        widget.setVolume(isNaN(v) ? 70 : v);
        this.setAttribute('aria-valuenow', String(v));
      });

      setButtonsEnabled(false);
    })();
  </script>

  <!-- Drawer logic -->
  <script>
    (function(){
      const root=document.documentElement;
      const btn=document.getElementById('menuBtn');
      const drawer=document.getElementById('drawer');
      const overlay=document.getElementById('drawerOverlay');
      const closeBtn=document.getElementById('drawerClose');

      const openDrawer=()=>{ root.classList.add('drawer-open'); btn.setAttribute('aria-expanded','true'); drawer.querySelector('a')?.focus(); };
      const closeDrawer=()=>{ root.classList.remove('drawer-open'); btn.setAttribute('aria-expanded','false'); btn.focus(); };

      btn.addEventListener('click',openDrawer);
      closeBtn.addEventListener('click',closeDrawer);
      overlay.addEventListener('click',closeDrawer);
      window.addEventListener('keydown',e=>{ if(e.key==='Escape') closeDrawer(); });
    })();
  </script>
</body>
</html>
