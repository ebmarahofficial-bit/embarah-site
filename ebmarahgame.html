<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>Ebmarah Game</title>

  <!-- Header/nav styles (from index) -->
  <style>
    :root { --neon:#00ff99; --glass:rgba(2,13,7,.75); }
    header{
      position:fixed; inset:0 0 auto 0;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 18px; background:var(--glass);
      border-bottom:1px solid rgba(0,255,128,.2);
      box-shadow:0 6px 24px rgba(0,0,0,.35); z-index:1000;
      backdrop-filter: blur(10px);
      font-family:'Orbitron',system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.02em}
    .brand img{height:40px; width:auto}
    .brand span{font-size:clamp(16px,2.6vw,22px); color:#e0ffe8}

    nav.site-nav{display:flex; align-items:center; gap:22px}
    nav.site-nav a{ color:#76ffb2; text-decoration:none; font-weight:700; font-size:clamp(13px,1.6vw,14px) }
    nav.site-nav a:hover{ color:#00ffea }

    .menu-btn{
      display:none; background:none; border:1px solid rgba(0,255,128,.35);
      color:#b9ffdf; font-size:16px; font-weight:700; padding:8px 12px; border-radius:10px
    }

    .drawer-overlay{ position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:999; opacity:0; pointer-events:none; transition:.25s;}
    .drawer{
      position:fixed; top:0; right:-320px; width:min(80vw,320px); height:100%;
      background:#03140c; border-left:1px solid rgba(0,255,128,.25);
      box-shadow:-12px 0 40px rgba(0,0,0,.45); z-index:1000; transition: right .25s ease;
      display:flex; flex-direction:column; padding:18px;
      font-family:'Orbitron',system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;
    }
    .drawer header{ all:unset; display:flex; align-items:center; justify-content:space-between; margin-bottom:8px }
    .drawer h2{ margin:0; font-size:18px; color:#9dffd2 }
    .drawer .close{ background:none; border:1px solid rgba(0,255,128,.35); color:#b9ffdf; padding:6px 10px; border-radius:10px }
    .drawer nav{ display:flex; flex-direction:column; margin-top:12px }
    .drawer nav a{
      padding:14px 10px; border-bottom:1px solid rgba(0,255,128,.15);
      color:#b9ffdf; text-decoration:none; font-weight:800; letter-spacing:.02em; font-size:16px;
    }
    .drawer nav a:last-child{ border-bottom:0 }
    .drawer nav a:active{ background:rgba(0,255,128,.08) }

    .drawer-open .drawer{ right:0 }
    .drawer-open .drawer-overlay{ opacity:1; pointer-events:auto }

    @media (max-width: 960px){
      nav.site-nav{ display:none }
      .menu-btn{ display:inline-flex }
    }
  </style>

  <link rel="stylesheet" href="css/galaxian.css" />

  <!-- Early mobile height var so first paint is correct -->
  <script>
    (function () {
      var setAppHeight = function(){ document.documentElement.style.setProperty('--app-h', window.innerHeight + 'px'); };
      setAppHeight();
      window.addEventListener('orientationchange', setAppHeight);
      window.addEventListener('resize', setAppHeight);
    })();
  </script>
</head>
<body>
  <!-- Site Header / Nav -->
  <header>
    <div class="brand">
      <img src="assets/favicon.png" alt="Ebmarah" />
      <span>Ebmarah</span>
    </div>
    <nav class="site-nav" aria-label="Primary">
      <a href="index.html">Home</a>
      <a class="nav-link" href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <a href="virtual-rave-room.html">Virtual Rave Room</a>
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <a href="ebmarahgame.html">Game</a>
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
    <button class="menu-btn" id="menuBtn" aria-haspopup="true" aria-expanded="false" aria-controls="drawer">Menu</button>
  </header>

  <div class="drawer-overlay" id="drawerOverlay"></div>
  <aside class="drawer" id="drawer" role="dialog" aria-modal="true" aria-label="Site menu">
    <header>
      <h2>Menu</h2>
      <button class="close" id="drawerClose" aria-label="Close menu">Close</button>
    </header>
    <nav aria-label="Mobile">
      <a href="index.html">Home</a>
      <a class="nav-link" href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <a href="ebmarahgame.html">Game</a>
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
  </aside>

  <!-- Video Background (hidden on mobile via CSS) -->
  <video id="bgVideo" class="bg-video" autoplay muted playsinline loop preload="none">
    <source src="assets/gamebg.mp4" type="video/mp4" />
  </video>
  <div class="bg-overlay"></div>

  <!-- Game -->
  <div class="page-offset">
    <main class="game-shell">
      <header class="hud">
        <div class="hud-left"><span class="title">Ebmarah: Game</span></div>
        <div class="hud-center">
          <span id="score">Score: 0</span>
          <span id="wave">Wave: 1</span>
          <span id="lives">Lives: 3</span>
        </div>
        <div class="hud-right" style="display:flex; gap:8px; align-items:center;">
          <!-- NEW: High Scores button -->
          <button id="highBtn" class="pause-btn" title="View High Scores">High Scores</button>
          <!-- NEW: game pause button -->
          <button id="pauseBtn" class="pause-btn">Pause</button>

          <!-- existing music controls -->
          <div class="music-controls">
            <button id="btnPrev" title="Previous">&#9664;&#9664;</button>
            <button id="btnPlay" title="Play/Pause">&#9654;</button>
            <button id="btnNext" title="Next">&#9654;&#9654;</button>
            <input id="vol" type="range" min="0" max="1" step="0.01" value="0.8" title="Volume"/>
          </div>
        </div>
      </header>

      <section class="game-stage">
        <canvas id="game" width="900" height="600"></canvas>

        <!-- tiny paused badge -->
        <div id="pauseBadge" class="paused-badge" hidden>Paused</div>

        <!-- touch buttons (kept but hidden by drag-mode) -->
        <div class="touch-controls" id="touchBtns">
          <button class="ctl" id="leftBtn">‚óÄ</button>
          <button class="ctl" id="fireBtn">‚¶ø</button>
          <button class="ctl" id="rightBtn">‚ñ∂</button>
        </div>

        <div id="gameOver" class="gameover-overlay" hidden>
          <div class="panel">
            <h2>Game Over</h2>
            <p>Score: <span id="finalScore">0</span> ‚Ä¢ Wave: <span id="finalWave">1</span></p>
            <button id="tryAgain" class="btn">Try Again</button>
          </div>
        </div>

        <!-- NEW: High Scores Modal -->
        <div id="highModal" class="modal" hidden>
          <div class="modal-panel" role="dialog" aria-modal="true" aria-labelledby="hsTitle">
            <h3 id="hsTitle">High Scores</h3>
            <ol id="hsList" class="hs-list"></ol>
            <div class="modal-actions">
              <button id="hsClose" class="btn">Close</button>
            </div>
          </div>
        </div>

      </section>

      <footer class="help">
        <p><strong>Controls:</strong> ‚Üê ‚Üí ‚Üë ‚Üì to move, Space to shoot, <strong>P</strong> or <strong>Esc</strong> to pause/resume. On phone: drag ship; it auto-fires.</p>
      </footer>
    </main>
  </div>

  <!-- Hidden SoundCloud Embed + API -->
  <iframe
    id="scPlayer"
    width="0" height="0" frameborder="no" scrolling="no"
    allow="autoplay"
    src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/ebmarah/tracks&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&visual=false">
  </iframe>
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <!-- 
  eb-dropdown.js: Replaces your desktop navigation (nav.site-nav) with a compact 
  "MENU" dropdown on screens >=1024px. Keeps your mobile nav intact on smaller 
  screens. The MENU button is pinned top-right and automatically lists your nav links. 
-->
<script src="js/eb-dropdown.js" defer></script>


  <!-- 
  weekly-locker.js: Alternates locking between ebmarahgame.html and drum-pad.html 
  each week. One link is locked (unclickable, dimmed, üîí added) while the other is 
  available. The lock/unlock switches automatically every Sunday at midnight (local time). 
-->
<script src="js/weekly-locker.js" defer></script>

  
  <!-- Menu toggles (same behavior as index) -->
  <script>
    (function(){
      const root = document.documentElement;
      const btn = document.getElementById('menuBtn');
      const drawer = document.getElementById('drawer');
      const overlay = document.getElementById('drawerOverlay');
      const closeBtn = document.getElementById('drawerClose');
      const openDrawer = () => { root.classList.add('drawer-open'); btn.setAttribute('aria-expanded','true'); drawer.querySelector('a')?.focus(); };
      const closeDrawer = () => { root.classList.remove('drawer-open'); btn.setAttribute('aria-expanded','false'); btn.focus(); };
      btn.addEventListener('click', openDrawer);
      closeBtn.addEventListener('click', closeDrawer);
      overlay.addEventListener('click', closeDrawer);
      window.addEventListener('keydown', e => { if(e.key === 'Escape') closeDrawer(); });
    })();
  </script>

  <!-- Game JS -->
  <script src="js/galaxian.js"></script>
</body>
</html>
