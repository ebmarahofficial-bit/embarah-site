<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ebmarah — Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="assets/favicon.png" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    :root { --neon:#00ff99; --bg:#020d07; --ink:#e0ffe8; --glass:rgba(2,13,7,.75); }

    * { box-sizing:border-box }
    html, body { height:100% }
    body { margin:0; font-family:'Orbitron',sans-serif; color:var(--ink); background:#020d07; overflow-x:hidden; }

    .video-bg{ position:fixed; inset:0; z-index:-3; overflow:hidden }
    .video-bg video{ width:100%; height:100%; object-fit:cover; object-position:center; }
    video::-webkit-media-controls{ display:none !important; }

    header{
      position:fixed; inset:0 0 auto 0;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 18px; background:var(--glass);
      border-bottom:1px solid rgba(0,255,128,.2); box-shadow:0 6px 24px rgba(0,0,0,.35); z-index:1000;
      backdrop-filter: blur(10px);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.02em}
    .brand img{height:40px; width:auto}
    .brand span{font-size:clamp(16px,2.6vw,22px)}

    nav.site-nav{display:flex; align-items:center; gap:22px}
    nav.site-nav a{ color:#76ffb2; text-decoration:none; font-weight:700; font-size:clamp(13px,1.6vw,14px) }
    nav.site-nav a:hover{ color:#00ffea }
    .menu-btn{ display:none; background:none; border:1px solid rgba(0,255,128,.35); color:#b9ffdf; font-size:16px; font-weight:700; padding:8px 12px; border-radius:10px }

    .drawer-overlay{ position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:999; opacity:0; pointer-events:none; transition:.25s; }
    .drawer{
      position:fixed; top:0; right:-320px; width:min(80vw,320px); height:100%;
      background:#03140c; border-left:1px solid rgba(0,255,128,.25);
      box-shadow:-12px 0 40px rgba(0,0,0,.45); z-index:1000; transition:right .25s ease;
      display:flex; flex-direction:column; padding:18px;
    }
    .drawer header{ all:unset; display:flex; align-items:center; justify-content:space-between; margin-bottom:8px }
    .drawer h2{ margin:0; font-size:18px; color:#9dffd2 }
    .drawer .close{ background:none; border:1px solid rgba(0,255,128,.35); color:#b9ffdf; padding:6px 10px; border-radius:10px }
    .drawer nav{ display:flex; flex-direction:column; margin-top:12px }
    .drawer nav a{ padding:14px 10px; border-bottom:1px solid rgba(0,255,128,.15); color:#b9ffdf; text-decoration:none; font-weight:800; letter-spacing:.02em; font-size:16px; }
    .drawer nav a:last-child{ border-bottom:0 }
    .drawer nav a:active{ background:rgba(0,255,128,.08) }
    .drawer-open .drawer{ right:0 }
    .drawer-open .drawer-overlay{ opacity:1; pointer-events:auto }

    .spacer{ height:70px }
    .wrap{ padding: clamp(12px,2vw,24px); display:grid; place-items:center; }
    .card{ width:min(1400px,98vw); padding:16px; text-align:center; }
    h1{ margin:6px 0 16px; letter-spacing:.04em; color:var(--neon); text-shadow:0 0 12px rgba(0,255,153,.6); }

    .grid{ display:grid; gap:16px; grid-template-columns:1fr; }
    @media (min-width:980px){ .grid{ grid-template-columns:2fr 1fr; align-items:start } }

    .player, .chat-embed{ border-radius:12px; overflow:hidden; }
    .player{ aspect-ratio:16/9; position:relative; }
    .chat-embed{ min-height:420px; position:relative; }

    .player iframe, .chat-embed iframe{ width:100%; height:100%; border:0; display:block; background:transparent !important; }

    .badge{
      position:absolute; top:10px; left:10px; padding:6px 10px; font-size:.85rem;
      background:rgba(0,0,0,.55); color:var(--neon); border:1px solid rgba(0,255,153,.35); border-radius:999px;
      text-transform:uppercase; letter-spacing:.08em; z-index:2;
    }
    .badge.offline{ color:#ff7070; }

    footer.site{ margin:20px auto 6px; width:min(1400px,98vw); text-align:center; opacity:.75; font-size:.85rem; }

    @media (max-width: 960px){
      nav.site-nav{ display:none }
      .menu-btn{ display:inline-flex }
    }
  </style>
</head>
<body>

  <!-- Background video -->
  <div class="video-bg" aria-hidden="true">
    <video autoplay loop muted playsinline preload="auto">
      <source src="video/bg2.mp4" type="video/mp4" />
    </video>
  </div>

  <!-- Header -->
  <header>
    <div class="brand">
      <img src="assets/favicon.png" alt="Ebmarah" />
      <span>Ebmarah</span>
    </div>
    <nav class="site-nav" aria-label="Primary">
      <a href="index.html">Home</a>
       <!-- <a href="music.html">Music</a> -->
      <a class="nav-link" href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <a href="virtual-rave-room.html">Virtual Rave Room</a>
      <!-- <a href="game.html">Game</a> -->
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <a href="ebmarahgame.html">Game</a>
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
    <button class="menu-btn" id="menuBtn">Menu</button>
  </header>

  <!-- Offcanvas drawer -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
  <aside class="drawer" id="drawer" role="dialog" aria-modal="true" aria-label="Site menu">
    <header>
      <h2>Menu</h2>
      <button class="close" id="drawerClose">Close</button>
    </header>
    <nav aria-label="Mobile">
      <a href="index.html">Home</a>
       <!-- <a href="music.html">Music</a> -->
      <a class="nav-link" href="live.html">Live</a>
      <a href="sample-packs.html">Sample Packs</a>
      <a href="about.html">About</a>
      <!-- <a href="game.html">Game</a> -->
      <a href="drum-pad.html">BeEbmarah</a>
      <a href="hommies.html">Hommies</a>
      <!-- <a href="ebmarahgame.html">Game</a> -->
      <a href="samples.html">Fan Vocal Booth</a>
      <a href="samples-library.html">Vocal Library</a>
      <a href="contact.html">Contact</a>
    </nav>
  </aside>

  <div class="spacer"></div>

  <!-- Live Section -->
  <div class="wrap">
    <div class="card">
      <h1>LIVE: Digital Gorilla Forest</h1>
      <div class="grid" id="liveGrid">

        <!-- Player: always uses channel live stream -->
        <section class="player" aria-label="Live video">
          <div class="badge" id="liveBadge">● Live</div>
          <iframe
            id="livePlayer"
            src="https://www.youtube.com/embed/live_stream?channel=UC4TFxZzu6BKLRfAWnsZFnRA&autoplay=1&mute=1&modestbranding=1&rel=0&wmode=transparent&enablejsapi=1"
            title="YouTube Live Player"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen></iframe>
        </section>

        <!-- Chat: filled dynamically by backend resolver -->
        <aside class="chat" aria-label="Live chat">
          <div class="chat-embed" id="chatEmbed">
            <div style="display:grid;place-items:center;height:100%;text-align:center;padding:20px;">
              <h2 style="color:var(--neon);font-size:1.2rem;margin:0 0 6px;">Standby — Chat</h2>
              <p style="opacity:.85;margin:0;">We’ll pull the live chat automatically when you’re online.</p>
            </div>
          </div>
        </aside>

      </div>
    </div>
  </div>

  <footer class="site">© <span id="year"></span> Ebmarah — Digital Gorilla Forest</footer>

  <script>
    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    
    // Drawer controls
    const root = document.documentElement;
    const menuBtn = document.getElementById('menuBtn');
    const drawer = document.getElementById('drawer');
    const overlay = document.getElementById('drawerOverlay');
    const closeBtn = document.getElementById('drawerClose');
    const openDrawer = () => { root.classList.add('drawer-open'); menuBtn.setAttribute('aria-expanded','true'); };
    const closeDrawer = () => { root.classList.remove('drawer-open'); menuBtn.setAttribute('aria-expanded','false'); };
    menuBtn.addEventListener('click', openDrawer);
    closeBtn.addEventListener('click', closeDrawer);
    overlay.addEventListener('click', closeDrawer);
    window.addEventListener('keydown', e => { if (e.key === 'Escape') closeDrawer(); });

    // ===== Live Chat Auto-Detect (backend resolver) =====
    const CHANNEL_ID = "UC4TFxZzu6BKLRfAWnsZFnRA";
    const RESOLVER_URL = "/api/youtube-live-id?channel=" + encodeURIComponent(CHANNEL_ID);
    const chatWrap = document.getElementById('chatEmbed');
    const domain = location.hostname;

    function setChat(videoId){
      chatWrap.innerHTML = `
        <iframe
          id="chatFrame"
          src="https://www.youtube.com/live_chat?v=${encodeURIComponent(videoId)}&embed_domain=${domain}"
          title="YouTube Live Chat"
          style="background:transparent;"></iframe>`;
    }

    function showFallback(){
      chatWrap.innerHTML = `
        <div style="display:grid;place-items:center;padding:16px;text-align:center;
                    background:rgba(0,0,0,.45);border:1px solid rgba(0,255,128,.25);border-radius:12px;">
          <p style="margin:0 0 10px;">Chat is unavailable right now.</p>
          <a href="https://www.youtube.com/@Ebmarah/live" target="_blank" rel="noopener"
             style="display:inline-block;padding:10px 14px;border:1px solid rgba(0,255,128,.45);
                    border-radius:10px;color:#b9ffdf;text-decoration:none;font-weight:800;">
            Open Chat on YouTube
          </a>
        </div>`;
    }

    async function resolveLiveId(){
      try{
        const res = await fetch(RESOLVER_URL, { cache: "no-store" });
        if (!res.ok) throw 0;
        const data = await res.json();
        if (data && data.videoId) setChat(data.videoId);
        else showFallback();
      } catch { showFallback(); }
    }

    resolveLiveId();
    // Re-check every 3 minutes so waiting visitors get chat once you go live
    setInterval(resolveLiveId, 180000);
  </script>

  <!-- easter egg -->

  <script src="js/shutupjustin.js"></script>
  
</body>
</html>
